(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2afa66ec"],{"01a2":function(t,e,i){"use strict";var a,n,s,o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"backTopButton",style:{right:t.right+"px",bottom:t.bottom+"px"}},[i("transition",{attrs:{name:"van-fade"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.showBackTop,expression:"showBackTop"}],on:{touchstart:function(e){return e.stopPropagation(),t.backTop(e)}}},[i("span",{staticClass:"icon iconfont icon-huidaodingbu"})])])],1)},r=[],c=(i("c5f6"),i("c665")),l=i("dc0a"),u=i("aa9a"),f=i("d328"),d=i("11d9"),h=i("9ab4"),g=i("2b0e"),b=i("60a3"),p=function(t){function e(){var t;return Object(c["a"])(this,e),t=Object(f["a"])(this,Object(d["a"])(e).apply(this,arguments)),t.container=null,t.showBackTop=!1,t.totalScrollTime=300,t.step=0,t.stepScrollTime=10,t.currentTimer=null,t}return Object(u["a"])(e,[{key:"mounted",value:function(){this.$nextTick(function(){this.container=document.getElementById(this.containerId)})}},{key:"onContainerChange",value:function(t,e){this.addScrollEventListener()}},{key:"addScrollEventListener",value:function(){this.container&&this.container.addEventListener("scroll",this.onScrollChange)}},{key:"activated",value:function(){this.onScrollChange()}},{key:"onScrollChange",value:function(){if(this.container){var t=this.container.scrollTop;this.showBackTop=t>=this.distance}}},{key:"backTop",value:function(){this.targetElement?this.targetElement.scrollIntoView():this.container.scrollTop=0}},{key:"startScroll",value:function(){var t=this;this.container.scrollTop-=this.step,this.container.scrollTop<=0||(this.currentTimer=setInterval(function(){t.container.scrollTop-=t.step,t.container.scrollTop<=0&&clearInterval(t.currentTimer)},this.stepScrollTime))}},{key:"destroyed",value:function(){this.container&&this.container.removeEventListener("scroll",this.onScrollChange)}}]),Object(l["a"])(e,t),e}(g["default"]);h["a"]([Object(b["d"])({default:40}),h["b"]("design:type","function"===typeof(a="undefined"!==typeof Number&&Number)?a:Object)],p.prototype,"right",void 0),h["a"]([Object(b["d"])({default:70}),h["b"]("design:type","function"===typeof(n="undefined"!==typeof Number&&Number)?n:Object)],p.prototype,"bottom",void 0),h["a"]([Object(b["d"])({default:300}),h["b"]("design:type","function"===typeof(s="undefined"!==typeof Number&&Number)?s:Object)],p.prototype,"distance",void 0),h["a"]([Object(b["d"])({default:""}),h["b"]("design:type",String)],p.prototype,"containerId",void 0),h["a"]([Object(b["d"])({default:null}),h["b"]("design:type",Object)],p.prototype,"targetElement",void 0),h["a"]([Object(b["f"])("container"),h["b"]("design:type",Function),h["b"]("design:paramtypes",[Object,Object]),h["b"]("design:returntype",void 0)],p.prototype,"onContainerChange",null),p=h["a"]([b["a"]],p);var v=p,S=v,m=S,y=(i("e608"),i("2877")),V=Object(y["a"])(m,o,r,!1,null,"06b594a0",null);V.options.__file="crmBackTop.vue";e["a"]=V.exports},"0bfb":function(t,e,i){"use strict";var a=i("cb7c");t.exports=function(){var t=a(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e}},"11e9":function(t,e,i){var a=i("52a7"),n=i("4630"),s=i("6821"),o=i("6a99"),r=i("69a8"),c=i("c69a"),l=Object.getOwnPropertyDescriptor;e.f=i("9e1e")?l:function(t,e){if(t=s(t),e=o(e,!0),c)try{return l(t,e)}catch(t){}if(r(t,e))return n(!a.f.call(t,e),t[e])}},"278c":function(t,e,i){"use strict";var a=i("b53a"),n=i.n(a);n.a},3124:function(t,e,i){},"3b2b":function(t,e,i){var a=i("7726"),n=i("5dbc"),s=i("86cc").f,o=i("9093").f,r=i("aae3"),c=i("0bfb"),l=a.RegExp,u=l,f=l.prototype,d=/a/g,h=/a/g,g=new l(d)!==d;if(i("9e1e")&&(!g||i("79e5")(function(){return h[i("2b4c")("match")]=!1,l(d)!=d||l(h)==h||"/a/i"!=l(d,"i")}))){l=function(t,e){var i=this instanceof l,a=r(t),s=void 0===e;return!i&&a&&t.constructor===l&&s?t:n(g?new u(a&&!s?t.source:t,e):u((a=t instanceof l)?t.source:t,a&&s?c.call(t):e),i?this:f,l)};for(var b=function(t){t in l||s(l,t,{configurable:!0,get:function(){return u[t]},set:function(e){u[t]=e}})},p=o(u),v=0;p.length>v;)b(p[v++]);f.constructor=l,l.prototype=f,i("2aba")(a,"RegExp",l)}i("7a56")("RegExp")},"46c4":function(t,e,i){"use strict";var a=i("b970"),n=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3e3,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"bottom";Object(a["b"])({message:t,duration:e,position:i})},s=function(t,e){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=a["a"].alert({title:t,message:e,overlay:i,closeOnClickOverlay:!0});return n},o=function(t,e){var i=a["a"].confirm({title:t,message:e});return i},r={toastMessage:n,dialogAlert:s,dialogConfirm:o};e["a"]=r},"52a7":function(t,e){e.f={}.propertyIsEnumerable},"5dbc":function(t,e,i){var a=i("d3f4"),n=i("8b97").set;t.exports=function(t,e,i){var s,o=e.constructor;return o!==i&&"function"==typeof o&&(s=o.prototype)!==i.prototype&&a(s)&&n&&n(t,s),t}},"8b97":function(t,e,i){var a=i("d3f4"),n=i("cb7c"),s=function(t,e){if(n(t),!a(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,a){try{a=i("9b43")(Function.call,i("11e9").f(Object.prototype,"__proto__").set,2),a(t,[]),e=!(t instanceof Array)}catch(t){e=!0}return function(t,i){return s(t,i),e?t.__proto__=i:a(t,i),t}}({},!1):void 0),check:s}},9093:function(t,e,i){var a=i("ce10"),n=i("e11e").concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return a(t,n)}},9290:function(t,e,i){"use strict";i("3b2b"),i("a481");var a=function(t,e){if(!t)return"";"string"===typeof t&&(t=new Date(t)),/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(t.getFullYear()+"").substr(4-RegExp.$1.length)));var i={"M+":t.getMonth()+1,"d+":t.getDate(),"h+":t.getHours(),"m+":t.getMinutes(),"s+":t.getSeconds()};for(var a in i){var s=i[a]+"";new RegExp("(".concat(a,")")).test(e)&&(e=e.replace(RegExp.$1,1===RegExp.$1.length?s:n(s)))}return e};function n(t){return("00"+t).substr(t.length)}var s=function(t){if(!t)return"暂无拜访信息";"string"===typeof t&&(t=new Date(t));var e=new Date,i=Math.abs(e.getTime()-t.getTime()),a=Math.floor(i/864e5);return a>99&&(a=99),0===a?"今日已拜访":1===a?"昨日已拜访":a+"天未拜访"},o=function(t){return t?"拜访中":"已完成"},r=function(t,e){if(!t)return"--";if(!e)return a(t,"hh:mm:ss");t=new Date(t),e=new Date(e);var i=Math.abs(t.getTime()-e.getTime()),n=Math.floor(i/36e5),s=Math.floor(i%36e5/6e4);return n+"小时"+s+"分钟"},c=function(t,e){if(!t||!e)return"--";t=new Date(t),e=new Date(e);var i=Math.abs(t.getTime()-e.getTime()),a=Math.floor(i/36e5),n=Math.floor(i%36e5/6e4);return a+"小时"+n+"分钟"},l=function(t){if(!t)return"--";t=new Date(t);var e=new Date;if(g(t,e))return"今天";var i=new Date(e.setDate(e.getDate()-1));return g(t,i)?"昨天":a(t,"yyyy-MM-dd")},u=function(t){return t&&"--"!==t?"今天"===t?"#ED340D":"昨天"===t?"#F68A1E":"#b2b2b2":"#b2b2b2"},f=function(t){return t?1==t?"一般":2==t?"高":"未知":"未知"},d=function(t){return t?1==t?"新建":2==t?"处理中":3==t?"已结束":"未知":"未知"},h=function(t){return t?1==t?"#3fcc8e":2==t?"#47EA1B":"#b2b2b2":"#b2b2b2"},g=function(t,e){return t.getFullYear()===e.getFullYear()&&t.getMonth()===e.getMonth()&&t.getDate()===e.getDate()},b=function(t){if(""===t||null===t||void 0===t||-1===t)return"--m";if("number"!==typeof t&&(t=parseFloat(t)),t<1e3)return t.toFixed(0)+" m";var e=(t/1e3).toFixed(1);return e+" km"},p=function(t){return t||"--"},v=function(t){return t?"在职":"离职"},S={formatDateTime:a,formatVisitDays:s,formatDistance:b,formatCustomerLevel:p,formatIncumbent:v,formatVisitState:o,formatVisitTime:r,formatVisitDuration:c,formatVisitDate:l,dateEquals:g,formatVisitDateColor:u,formatItemLevel:f,formatItemState:d,formatItemStateColor:h};e["a"]=S},aa77:function(t,e,i){var a=i("5ca1"),n=i("be13"),s=i("79e5"),o=i("fdef"),r="["+o+"]",c="​",l=RegExp("^"+r+r+"*"),u=RegExp(r+r+"*$"),f=function(t,e,i){var n={},r=s(function(){return!!o[t]()||c[t]()!=c}),l=n[t]=r?e(d):o[t];i&&(n[i]=l),a(a.P+a.F*r,"String",n)},d=f.trim=function(t,e){return t=String(n(t)),1&e&&(t=t.replace(l,"")),2&e&&(t=t.replace(u,"")),t};t.exports=f},aae3:function(t,e,i){var a=i("d3f4"),n=i("2d95"),s=i("2b4c")("match");t.exports=function(t){var e;return a(t)&&(void 0!==(e=t[s])?!!e:"RegExp"==n(t))}},b53a:function(t,e,i){},c5f6:function(t,e,i){"use strict";var a=i("7726"),n=i("69a8"),s=i("2d95"),o=i("5dbc"),r=i("6a99"),c=i("79e5"),l=i("9093").f,u=i("11e9").f,f=i("86cc").f,d=i("aa77").trim,h="Number",g=a[h],b=g,p=g.prototype,v=s(i("2aeb")(p))==h,S="trim"in String.prototype,m=function(t){var e=r(t,!1);if("string"==typeof e&&e.length>2){e=S?e.trim():d(e,3);var i,a,n,s=e.charCodeAt(0);if(43===s||45===s){if(i=e.charCodeAt(2),88===i||120===i)return NaN}else if(48===s){switch(e.charCodeAt(1)){case 66:case 98:a=2,n=49;break;case 79:case 111:a=8,n=55;break;default:return+e}for(var o,c=e.slice(2),l=0,u=c.length;l<u;l++)if(o=c.charCodeAt(l),o<48||o>n)return NaN;return parseInt(c,a)}}return+e};if(!g(" 0o1")||!g("0b1")||g("+0x1")){g=function(t){var e=arguments.length<1?0:t,i=this;return i instanceof g&&(v?c(function(){p.valueOf.call(i)}):s(i)!=h)?o(new b(m(e)),i,g):m(e)};for(var y,V=i("9e1e")?l(b):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),C=0;V.length>C;C++)n(b,y=V[C])&&!n(g,y)&&f(g,y,u(b,y));g.prototype=p,p.constructor=g,i("2aba")(a,h,g)}},e608:function(t,e,i){"use strict";var a=i("3124"),n=i.n(a);n.a},ee38:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticClass:"fixedHeader"},[i("van-nav-bar",{staticClass:"headBar",on:{"click-right":t.goVisitSelectCustomer}},[i("span",{staticClass:"headBarTitle",attrs:{slot:"title"},slot:"title"},[t._v("拜访")]),i("span",{staticClass:"icon iconfont icon-xinzeng2 headBarIcon",attrs:{slot:"right"},slot:"right"})])],1),i("div",{staticClass:"content contentTop contentBottom",attrs:{id:"contentContainer"}},[i("van-tabs",{attrs:{"line-width":80,color:"#3fcc8e",swipeable:""},on:{change:t.tabChange},model:{value:t.activeTab,callback:function(e){t.activeTab=e},expression:"activeTab"}},[t.isLeader?i("van-tab",{attrs:{title:"下属拜访"}},[i("div",{staticClass:"vanTabContentContainer",style:{height:t.tabContentHeight+"px"},attrs:{id:"subContentContainer"}},[i("van-search",{staticClass:"vansearchClass",attrs:{placeholder:"请输入搜索关键词"},on:{search:t.loadSubordinateVisitDatas},model:{value:t.keywordSubordinate,callback:function(e){t.keywordSubordinate=e},expression:"keywordSubordinate"}}),i("van-pull-refresh",{on:{refresh:t.loadSubordinateVisitDatas},model:{value:t.isLoadingSubordinateRefresh,callback:function(e){t.isLoadingSubordinateRefresh=e},expression:"isLoadingSubordinateRefresh"}},[i("van-list",{staticClass:"crmVanList",attrs:{finished:t.finishedSubordinate,"immediate-check":!1,"finished-text":"没有更多了"},on:{load:t.loadNextSubordinateVisitDatas},model:{value:t.isLoadingSubordinateNext,callback:function(e){t.isLoadingSubordinateNext=e},expression:"isLoadingSubordinateNext"}},t._l(t.subordinateVisitList,function(e,a){return i("div",{key:a,staticClass:"itemContainer",on:{click:function(i){t.goSubordinateVisitDetails(e)}}},[i("van-row",{staticStyle:{height:"26px"},attrs:{type:"flex",align:"center"}},[i("van-col",{staticClass:"van-ellipsis subNameText",attrs:{offset:"1",span:"19"}},[t._v(t._s(e.CustomerName))]),i("van-col",{attrs:{span:"4"}},[i("van-tag",{attrs:{round:"",color:e.IsVisiting?"#3fcc8e":"#b2b2b2"}},[t._v(t._s(t._f("formatVisitState")(e.IsVisiting)))])],1)],1),i("van-row",{staticStyle:{height:"16px"},attrs:{type:"flex",align:"center"}},[i("van-col",{attrs:{offset:"1",span:"1"}},[i("span",{staticClass:"icon iconfont icon-location little_icon"})]),i("van-col",{staticClass:"van-ellipsis subAddressText",attrs:{span:"20"}},[t._v(t._s(e.BeginLocationDesc))]),i("van-col",{attrs:{span:"2"}},[i("span",{staticClass:"icon iconfont icon-gengduo little_icon icon_more"})])],1),i("van-row",{attrs:{type:"flex",align:"center"}},[i("van-col",{attrs:{offset:"1",span:"1"}},[i("span",{staticClass:"icon iconfont icon-wode little_icon"})]),i("van-col",{staticClass:"van-ellipsis subAddressText",attrs:{span:"8"}},[t._v(t._s(e.SalesArea?e.SalesArea:"--")+" > "+t._s(e.CreaterName))]),i("van-col",{attrs:{span:"1"}},[i("span",{staticClass:"icon iconfont little_icon",class:e.IsVisiting?"icon-tubiao_kaishishijian":"icon-tubiao_jieshushijian"})]),i("van-col",{staticClass:"van-ellipsis subAddressText",attrs:{span:"7"}},[t._v(t._s(t._f("formatVisitTime")(e.CreateTime,e.FinishTime)))]),i("van-col",{attrs:{span:"6"}},[i("van-tag",{attrs:{plain:"",color:t._f("formatVisitDateColor")(t._f("formatVisitDate")(e.CreateTime))}},[t._v(t._s(t._f("formatVisitDate")(e.CreateTime)))])],1)],1)],1)}))],1),i("crmBackTop",{attrs:{containerId:"subContentContainer"}})],1)]):t._e(),i("van-tab",{attrs:{title:"我的拜访"}},[i("div",{staticClass:"vanTabContentContainer",style:{height:t.tabContentHeight+"px"},attrs:{id:"selfContentContainer"}},[i("van-search",{staticClass:"vansearchClass",attrs:{placeholder:"请输入搜索关键词"},on:{search:t.loadSelfVisitDatas},model:{value:t.keywordSelf,callback:function(e){t.keywordSelf=e},expression:"keywordSelf"}}),i("van-pull-refresh",{on:{refresh:t.loadSelfVisitDatas},model:{value:t.isLoadingSelfRefresh,callback:function(e){t.isLoadingSelfRefresh=e},expression:"isLoadingSelfRefresh"}},[i("van-list",{staticClass:"crmVanList",attrs:{finished:t.finishedSelf,"immediate-check":!1,"finished-text":"没有更多了"},on:{load:t.loadNextSelfVisitDatas},model:{value:t.isLoadingSelfNext,callback:function(e){t.isLoadingSelfNext=e},expression:"isLoadingSelfNext"}},t._l(t.selfVisitList,function(e,a){return i("div",{key:a,staticClass:"itemContainer",on:{click:function(i){t.goSelfVisitDetails(e)}}},[i("van-row",{staticStyle:{height:"26px"},attrs:{type:"flex",align:"center"}},[i("van-col",{staticClass:"van-ellipsis subNameText",attrs:{offset:"1",span:"19"}},[t._v(t._s(e.CustomerName))]),i("van-col",{attrs:{span:"4"}},[i("van-tag",{attrs:{round:"",color:e.IsVisiting?"#3fcc8e":"#b2b2b2"}},[t._v(t._s(t._f("formatVisitState")(e.IsVisiting)))])],1)],1),i("van-row",{staticStyle:{height:"16px"},attrs:{type:"flex",align:"center"}},[i("van-col",{attrs:{offset:"1",span:"1"}},[i("span",{staticClass:"icon iconfont icon-location little_icon"})]),i("van-col",{staticClass:"van-ellipsis subAddressText",attrs:{span:"20"}},[t._v(t._s(e.BeginLocationDesc))]),i("van-col",{attrs:{span:"2"}},[i("span",{staticClass:"icon iconfont icon-gengduo little_icon icon_more"})])],1),i("van-row",{attrs:{type:"flex",align:"center"}},[i("van-col",{attrs:{offset:"1",span:"1"}},[i("span",{staticClass:"icon iconfont little_icon",class:e.IsVisiting?"icon-tubiao_kaishishijian":"icon-tubiao_jieshushijian"})]),i("van-col",{staticClass:"van-ellipsis subAddressText",attrs:{span:"16"}},[t._v(t._s(t._f("formatVisitTime")(e.CreateTime,e.FinishTime)))]),i("van-col",{attrs:{span:"6"}},[i("van-tag",{attrs:{plain:"",color:t._f("formatVisitDateColor")(t._f("formatVisitDate")(e.CreateTime))}},[t._v(t._s(t._f("formatVisitDate")(e.CreateTime)))])],1)],1)],1)}))],1),i("crmBackTop",{attrs:{containerId:"selfContentContainer"}})],1)])],1)],1)])},n=[],s=i("c665"),o=i("dc0a"),r=i("aa9a"),c=i("d328"),l=i("11d9"),u=i("9ab4"),f=i("2b0e"),d=i("60a3"),h=i("2b67"),g=i("9290"),b=i("46c4"),p=i("01a2"),v=function(t){function e(){var t;return Object(s["a"])(this,e),t=Object(c["a"])(this,Object(l["a"])(e).apply(this,arguments)),t.keywordSelf="",t.keywordSubordinate="",t.currentPageSubordinate=1,t.currentPageSelf=1,t.pageSize=20,t.activeTab=0,t.finishedSubordinate=!1,t.isLoadingSubordinateRefresh=!1,t.isLoadingSubordinateNext=!1,t.isLoadingSelfRefresh=!1,t.isLoadingSelfNext=!1,t.finishedSelf=!1,t.subordinateVisitList=[],t.selfVisitList=[],t.tabContentHeight=0,t}return Object(r["a"])(e,[{key:"created",value:function(){this.isLeader=JSON.parse(h["a"].instance.getIsLeader())}},{key:"mounted",value:function(){this.tabContentHeight=document.documentElement.clientHeight-90-50,this.tabChange(this.activeTab)}},{key:"tabChange",value:function(t){this.isLeader?0===t?(this.initSubordinateVisitDatas(),console.log("当前是下属拜访")):1===t&&(this.initSelfVisitDatas(),console.log("当前是我的拜访")):this.initSelfVisitDatas()}},{key:"initSubordinateVisitDatas",value:function(){this.subordinateVisitList&&0!==this.subordinateVisitList.length||this.$nextTick(function(){this.loadSubordinateVisitDatas()})}},{key:"initSelfVisitDatas",value:function(){this.selfVisitList&&0!==this.selfVisitList.length||this.$nextTick(function(){this.loadSelfVisitDatas()})}},{key:"onCurrentVisitIndicatorChanged",value:function(t,e){this.$store.state.currentVisitId?console.log("新增拜访啦!开始刷新数据"):console.log("结束拜访啦!开始刷新数据"),console.log(this.$store.state.currentVisitId),this.loadSelfVisitDatas()}},{key:"onkeywordSelfChanged",value:function(t,e){t&&""!==t||this.loadSelfVisitDatas()}},{key:"onkeywordSubordinateChanged",value:function(t,e){t&&""!==t||this.loadSubordinateVisitDatas()}},{key:"goVisitSelectCustomer",value:function(){this.$router.push("/visitSelectCustomer")}},{key:"goSubordinateVisitDetails",value:function(t){t&&t.Id&&this.goVisitDetails(t.Id)}},{key:"goSelfVisitDetails",value:function(t){t&&t.Id&&(t.IsVisiting?this.goCreateVisit(t.Id):this.goVisitDetails(t.Id))}},{key:"goVisitDetails",value:function(t){this.$router.push({path:"/visitDetails",query:{visitId:t}})}},{key:"goCreateVisit",value:function(t){this.$router.push({path:"/createVisit",query:{newVisitId:t}})}},{key:"getSelfVisitTotalPage",value:function(){return Math.ceil(this.totalCountSelf/this.pageSize)}},{key:"loadSelfVisitDatas",value:function(){var t=this;console.log("**********************************"),this.isLoadingSelfRefresh=!1,this.isLoadingSelfNext=!1,this.currentPageSelf=1,this.querySelfVisitList(function(){t.isLoadingSelfRefresh=!0},function(){t.isLoadingSelfRefresh=!1})}},{key:"loadNextSelfVisitDatas",value:function(){var t=this;console.log("----------------------------");var e=this.getSelfVisitTotalPage();this.currentPageSelf=this.currentPageSelf+1,this.currentPageSelf>e?this.finishedSelf=!0:this.querySelfVisitList(function(){t.isLoadingSelfNext=!0},function(){t.isLoadingSelfNext=!1})}},{key:"querySelfVisitList",value:function(t,e){var i=this,a=h["a"].instance.getPersonId();t();var n=(this.currentPageSelf-1)*this.pageSize;this.$Api.invoke({moduleName:"crm.visit.visitService",className:"VisitService",method:"getOwnerList",args:{personId:a,keyword:this.keywordSelf,skip:n,limit:this.pageSize}}).then(function(t){t.data&&t.data.isSuccess?i.querySelfVisitSuccess(t):i.querySelfVisitFailed(t)}).catch(function(t){i.querySelfVisitException(t)}).finally(function(){e()})}},{key:"querySelfVisitSuccess",value:function(t){this.totalCountSelf=t.data.data[0],console.log("当前页："+this.currentPageSelf+"总数"+this.totalCountSelf);var e=this.getSelfVisitTotalPage();isNaN(e)&&(this.finishedSelf=!0),this.currentPageSelf>=e?this.finishedSelf=!0:this.finishedSelf=!1,t.data.data[1]&&(1===this.currentPageSelf?this.selfVisitList=t.data.data[1]:this.selfVisitList=this.selfVisitList.concat(t.data.data[1]))}},{key:"querySelfVisitFailed",value:function(t){b["a"].toastMessage("查询我的拜访失败!"+t.data.error),console.log(t)}},{key:"querySelfVisitException",value:function(t){this.totalCountSelf=0,this.selfVisitList=[],this.finishedSelf=!0,b["a"].toastMessage("查询我的拜访异常!"+t),console.log(t)}},{key:"getSubordinateTotalPage",value:function(){return Math.ceil(this.totalCountSubordinate/this.pageSize)}},{key:"loadSubordinateVisitDatas",value:function(){var t=this;console.log("****************************"),this.isLoadingSubordinateRefresh=!1,this.isLoadingSubordinateNext=!1,this.currentPageSubordinate=1,this.querySubordinateVisitList(function(){t.isLoadingSubordinateRefresh=!0},function(){t.isLoadingSubordinateRefresh=!1})}},{key:"loadNextSubordinateVisitDatas",value:function(){var t=this;console.log("----------------------------");var e=this.getSubordinateTotalPage();this.currentPageSubordinate=this.currentPageSubordinate+1,isNaN(e)||this.currentPageSubordinate>e?this.finishedSubordinate=!0:this.querySubordinateVisitList(function(){t.isLoadingSubordinateNext=!0},function(){t.isLoadingSubordinateNext=!1})}},{key:"querySubordinateVisitList",value:function(t,e){var i=this,a=h["a"].instance.getPersonId();t();var n=(this.currentPageSubordinate-1)*this.pageSize;this.$Api.invoke({moduleName:"crm.visit.visitService",className:"VisitService",method:"getSubordinateList",args:{personId:a,keyword:this.keywordSubordinate,skip:n,limit:this.pageSize}}).then(function(t){t.data&&t.data.isSuccess?i.querySubordinateListSuccess(t):i.querySubordinateListFailed(t)}).catch(function(t){i.querySubordinateListException(t)}).finally(function(){e()})}},{key:"querySubordinateListSuccess",value:function(t){this.totalCountSubordinate=t.data.data[0],console.log("当前页："+this.currentPageSubordinate),console.log("总数"+this.totalCountSubordinate);var e=this.getSubordinateTotalPage();isNaN(e)&&(this.finishedSubordinate=!0),this.currentPageSubordinate>=e?this.finishedSubordinate=!0:this.finishedSubordinate=!1,t.data.data[1]&&(1===this.currentPageSubordinate?this.subordinateVisitList=t.data.data[1]:this.subordinateVisitList=this.subordinateVisitList.concat(t.data.data[1]))}},{key:"querySubordinateListFailed",value:function(t){b["a"].toastMessage("查询下属拜访失败!"+t.data.error),console.log(t)}},{key:"querySubordinateListException",value:function(t){this.totalCountSubordinate=0,this.subordinateVisitList=[],this.finishedSubordinate=!0,b["a"].toastMessage("查询下属拜访异常!"+t),console.log(t)}},{key:"currentVisitIndicator",get:function(){return this.$store.state.currentVisitIndicator}}]),Object(o["a"])(e,t),e}(f["default"]);u["a"]([Object(d["f"])("currentVisitIndicator"),u["b"]("design:type",Function),u["b"]("design:paramtypes",[Object,Object]),u["b"]("design:returntype",void 0)],v.prototype,"onCurrentVisitIndicatorChanged",null),u["a"]([Object(d["f"])("keywordSelf"),u["b"]("design:type",Function),u["b"]("design:paramtypes",[String,String]),u["b"]("design:returntype",void 0)],v.prototype,"onkeywordSelfChanged",null),u["a"]([Object(d["f"])("keywordSubordinate"),u["b"]("design:type",Function),u["b"]("design:paramtypes",[String,String]),u["b"]("design:returntype",void 0)],v.prototype,"onkeywordSubordinateChanged",null),v=u["a"]([Object(d["a"])({components:{crmBackTop:p["a"]},filters:{formatDateTime:function(t){return g["a"].formatDateTime(t,"yyyy-MM-dd hh:mm:ss")},formatVisitState:function(t){return g["a"].formatVisitState(t)},formatVisitTime:function(t,e){return g["a"].formatVisitTime(t,e)},formatVisitDate:function(t){return g["a"].formatVisitDate(t)},formatVisitDateColor:function(t){return g["a"].formatVisitDateColor(t)}}})],v);var S=v,m=S,y=m,V=(i("278c"),i("2877")),C=Object(V["a"])(y,a,n,!1,null,"69a4ce42",null);C.options.__file="visit.vue";e["default"]=C.exports},fdef:function(t,e){t.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"}}]);