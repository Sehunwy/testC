(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-70cfa1e8"],{"133e":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAcUlEQVRYw+3XMQqAMAyF4d7MS2hzK0/WMXgXpRBT6GgWkZfBN/yEDoVvTIqZlcwKAW8+LW0fVU+9c87xhgFWzx6qKIAGAEUBegDoKIBFEUAAAQQQQAABBPwGkL6SpS+lWwAQ5GEi3uFdcwrsMOFt+GU3b/2iKWSc49cAAAAASUVORK5CYII="},2312:function(e,t,a){"use strict";var n=a("f332"),i=a.n(n);i.a},"3b33":function(e,t,a){},"3cda":function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"alignCenter width100"},[a("van-loading",{staticStyle:{display:"inline-block"}})],1)},i=[],o=a("c665"),s=a("dc0a"),l=a("d328"),r=a("11d9"),c=a("9ab4"),u=a("2b0e"),d=a("60a3"),m=function(e){function t(){return Object(o["a"])(this,t),Object(l["a"])(this,Object(r["a"])(t).apply(this,arguments))}return Object(s["a"])(t,e),t}(u["default"]);m=c["a"]([d["a"]],m);var p=m,C=p,h=C,f=(a("6e19"),a("2877")),v=Object(f["a"])(h,n,i,!1,null,"04a46e72",null);v.options.__file="crmLoading.vue";t["a"]=v.exports},"46c4":function(e,t,a){"use strict";var n=a("b970"),i=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3e3,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"bottom";Object(n["b"])({message:e,duration:t,position:a})},o=function(e,t){var a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=n["a"].alert({title:e,message:t,overlay:a,closeOnClickOverlay:!0});return i},s=function(e,t){var a=n["a"].confirm({title:e,message:t});return a},l={toastMessage:i,dialogAlert:o,dialogConfirm:s};t["a"]=l},"5ca5":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("van-nav-bar",{staticClass:"headBar fixedHeader",on:{"click-left":e.goBack,"click-right":e.confirmCreateCustomer}},[n("span",{staticClass:"icon iconfont icon-fanhui headBarIcon",attrs:{slot:"left"},slot:"left"}),n("span",{staticClass:"headBarTitle",attrs:{slot:"title"},slot:"title"},[e._v("新增客户")]),n("span",{staticClass:"icon iconfont icon-queding headBarIcon",attrs:{slot:"right"},slot:"right"})]),n("div",{staticClass:"content contentTop",attrs:{id:"contentContainer"}},[n("crmLoading",{directives:[{name:"show",rawName:"v-show",value:e.isBusy,expression:"isBusy"}]}),n("van-cell-group",[n("van-field",{attrs:{label:"位置","left-icon":"icon iconfont icon-location",type:"textarea",autosize:"",rows:"1",disabled:""},model:{value:e.newCustomer.LocationDesc,callback:function(t){e.$set(e.newCustomer,"LocationDesc",t)},expression:"newCustomer.LocationDesc"}})],1),n("van-cell-group",{staticStyle:{"margin-top":"10px"}},[n("van-field",{attrs:{label:"客户名称",placeholder:"请输入客户名称","input-align":"right",type:"textarea",autosize:"",rows:"1",required:"","error-message":""},model:{value:e.newCustomer.Name,callback:function(t){e.$set(e.newCustomer,"Name",t)},expression:"newCustomer.Name"}}),n("van-field",{attrs:{label:"客户地址",placeholder:"请输入客户地址","input-align":"right",type:"textarea",autosize:"",rows:"1",required:"","error-message":""},model:{value:e.newCustomer.Address,callback:function(t){e.$set(e.newCustomer,"Address",t)},expression:"newCustomer.Address"}}),n("van-field",{attrs:{label:"客户编码",placeholder:"请输入客户编码","input-align":"right"},model:{value:e.newCustomer.Cd,callback:function(t){e.$set(e.newCustomer,"Cd",t)},expression:"newCustomer.Cd"}}),n("van-field",{attrs:{label:"客户简称",placeholder:"请输入客户简称","input-align":"right"},model:{value:e.newCustomer.SimpleName,callback:function(t){e.$set(e.newCustomer,"SimpleName",t)},expression:"newCustomer.SimpleName"}}),n("van-field",{attrs:{label:"电话",placeholder:"请输入电话","input-align":"right"},model:{value:e.newCustomer.Telephone,callback:function(t){e.$set(e.newCustomer,"Telephone",t)},expression:"newCustomer.Telephone"}}),n("van-field",{attrs:{label:"传真",placeholder:"请输入传真","input-align":"right"},model:{value:e.newCustomer.Fax,callback:function(t){e.$set(e.newCustomer,"Fax",t)},expression:"newCustomer.Fax"}}),n("van-field",{attrs:{label:"管理公司",placeholder:"请选择管理公司","input-align":"right",readonly:"","is-link":""},on:{click:function(t){e.openSelectDictionaryValue("ManagementCompany","管理公司",e.newCustomer.ManagementCompany,function(t){e.newCustomer.ManagementCompany=t})}},model:{value:e.newCustomer.ManagementCompany,callback:function(t){e.$set(e.newCustomer,"ManagementCompany",t)},expression:"newCustomer.ManagementCompany"}}),n("van-field",{attrs:{label:"客户等级",placeholder:"请选择客户等级","input-align":"right",readonly:"","is-link":""},on:{click:function(t){e.openSelectDictionaryValue("CustomerLevel","客户等级",e.newCustomer.Level,function(t){e.newCustomer.Level=t})}},model:{value:e.newCustomer.Level,callback:function(t){e.$set(e.newCustomer,"Level",t)},expression:"newCustomer.Level"}}),n("van-field",{attrs:{label:"开发进度",placeholder:"请选择开发进度","input-align":"right",readonly:"","is-link":""},on:{click:function(t){e.openSelectDictionaryValue("DevelopmentProgress","开发进度",e.newCustomer.DevelopProgress,function(t){e.newCustomer.DevelopProgress=t})}},model:{value:e.newCustomer.DevelopProgress,callback:function(t){e.$set(e.newCustomer,"DevelopProgress",t)},expression:"newCustomer.DevelopProgress"}}),n("van-field",{attrs:{label:"客户行业分类",placeholder:"请选择客户行业分类","input-align":"right",readonly:"","is-link":""},on:{click:function(t){e.openSelectDictionaryValue("CustomerIndustryCategory","客户行业分类",e.newCustomer.IndustryCategory,function(t){e.newCustomer.IndustryCategory=t})}},model:{value:e.newCustomer.IndustryCategory,callback:function(t){e.$set(e.newCustomer,"IndustryCategory",t)},expression:"newCustomer.IndustryCategory"}})],1),n("van-cell-group",{staticStyle:{"margin-top":"10px"}},[n("van-field",{attrs:{label:"客户主要产品",placeholder:"请输入客户主要产品",type:"textarea",autosize:{maxHeight:120,minHeight:80}},model:{value:e.newCustomer.MainProduction,callback:function(t){e.$set(e.newCustomer,"MainProduction",t)},expression:"newCustomer.MainProduction"}}),n("van-field",{attrs:{label:"客户兴趣爱好",placeholder:"请输入客户兴趣爱好",type:"textarea",autosize:{maxHeight:120,minHeight:80}},model:{value:e.newCustomer.Hobbies,callback:function(t){e.$set(e.newCustomer,"Hobbies",t)},expression:"newCustomer.Hobbies"}}),n("van-field",{attrs:{label:"客户账期",placeholder:"请输入客户账期",type:"textarea",autosize:{maxHeight:120,minHeight:80}},model:{value:e.newCustomer.AccountPeriod,callback:function(t){e.$set(e.newCustomer,"AccountPeriod",t)},expression:"newCustomer.AccountPeriod"}}),n("van-field",{attrs:{label:"客户信用",placeholder:"请输入客户信用",type:"textarea",autosize:{maxHeight:120,minHeight:80}},model:{value:e.newCustomer.CreditSituation,callback:function(t){e.$set(e.newCustomer,"CreditSituation",t)},expression:"newCustomer.CreditSituation"}}),n("van-field",{attrs:{label:"合同约定",placeholder:"请输入合同约定",type:"textarea",autosize:{maxHeight:120,minHeight:80}},model:{value:e.newCustomer.ContractAgreement,callback:function(t){e.$set(e.newCustomer,"ContractAgreement",t)},expression:"newCustomer.ContractAgreement"}}),n("van-field",{attrs:{label:"客户规模",placeholder:"请输入客户规模",type:"textarea",autosize:{maxHeight:120,minHeight:80}},model:{value:e.newCustomer.BusinessScale,callback:function(t){e.$set(e.newCustomer,"BusinessScale",t)},expression:"newCustomer.BusinessScale"}}),n("van-field",{attrs:{label:"竞品情况",placeholder:"请输入竞品情况",type:"textarea",autosize:{maxHeight:120,minHeight:80}},model:{value:e.newCustomer.CompetitorSituation,callback:function(t){e.$set(e.newCustomer,"CompetitorSituation",t)},expression:"newCustomer.CompetitorSituation"}}),n("van-field",{attrs:{label:"竞品分析",placeholder:"请输入竞品分析",type:"textarea",autosize:{maxHeight:120,minHeight:80}},model:{value:e.newCustomer.CompetitorAnalysis,callback:function(t){e.$set(e.newCustomer,"CompetitorAnalysis",t)},expression:"newCustomer.CompetitorAnalysis"}}),n("van-field",{attrs:{label:"备注",placeholder:"请输入备注",type:"textarea",autosize:{maxHeight:120,minHeight:80}},model:{value:e.newCustomer.Remark,callback:function(t){e.$set(e.newCustomer,"Remark",t)},expression:"newCustomer.Remark"}})],1),n("van-cell-group",{staticStyle:{"margin-top":"10px"}},[n("div",{staticClass:"contactContainer"},[n("div",{staticClass:"createHeader flexRowLayout van-hairline--bottom"},[n("div",{staticClass:"flexRowLayout",staticStyle:{"justify-content":"flex-start"}},[n("img",{attrs:{src:a("133e")}}),n("span",{staticClass:"headerText"},[e._v("客户联系人")])]),n("div",{staticClass:"headerCreateBtn",on:{click:e.createCustomerContact}},[n("span",{staticClass:"icon iconfont icon-xinzeng2"})])]),n("div",{staticClass:"createBody"},e._l(e.customerContacts,function(t,a){return n("div",{key:a,staticClass:"createBodyItem"},[n("van-cell-group",[n("van-field",{attrs:{label:"姓名",placeholder:"请输入联系人姓名","input-align":"right",required:""},model:{value:t.Name,callback:function(a){e.$set(t,"Name",a)},expression:"item.Name"}}),n("van-field",{attrs:{label:"电话",placeholder:"请输入联系人电话","input-align":"right",required:""},model:{value:t.Telephone,callback:function(a){e.$set(t,"Telephone",a)},expression:"item.Telephone"}}),n("van-field",{attrs:{label:"邮箱",placeholder:"请输入联系人邮箱","input-align":"right"},model:{value:t.Email,callback:function(a){e.$set(t,"Email",a)},expression:"item.Email"}}),n("van-field",{attrs:{label:"部门",placeholder:"请输入联系人部门","input-align":"right"},model:{value:t.Department,callback:function(a){e.$set(t,"Department",a)},expression:"item.Department"}}),n("van-field",{attrs:{label:"职位",placeholder:"请输入联系人职位","input-align":"right"},model:{value:t.Title,callback:function(a){e.$set(t,"Title",a)},expression:"item.Title"}}),n("van-cell",{attrs:{title:"-"}},[n("span",{staticClass:"icon iconfont icon-delete bodyDeleteBtn",on:{click:function(t){e.confirmDeleteCustomerContact(a)}}})])],1)],1)}))])])],1),n("van-popup",{staticStyle:{height:"100%",width:"100%"},attrs:{overlay:!1,"close-on-click-overlay":!1,position:"right"},model:{value:e.showSelectDictionaryValue,callback:function(t){e.showSelectDictionaryValue=t},expression:"showSelectDictionaryValue"}},[n("selectDictionaryValue",{attrs:{title:e.popupTitle,dicKey:e.popupDicKey,currentValue:e.popupOldValue},on:{cancel:e.cancelSelectDictionaryValue,complete:e.completeSelectDictionaryValue}})],1)],1)},i=[],o=(a("a481"),a("c665")),s=a("dc0a"),l=a("aa9a"),r=a("d328"),c=a("11d9"),u=a("9ab4"),d=a("2b0e"),m=a("60a3"),p=a("2b67"),C=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("van-nav-bar",{staticClass:"headBar fixedHeader",on:{"click-left":e.onCancel,"click-right":e.onComplete}},[a("span",{staticClass:"icon iconfont icon-fanhui headBarIcon",attrs:{slot:"left"},slot:"left"}),a("span",{staticClass:"headBarTitle",attrs:{slot:"title"},slot:"title"},[e._v(e._s(e.title))]),a("span",{staticClass:"icon iconfont icon-queding headBarIcon",attrs:{slot:"right"},slot:"right"})]),a("div",{staticClass:"content contentTop",attrs:{id:"contentContainer"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.isBusy,expression:"isBusy"}],staticClass:"alignCenter width100"},[a("van-loading",{staticStyle:{display:"inline-block"}})],1),a("van-radio-group",{model:{value:e.selectedValue,callback:function(t){e.selectedValue=t},expression:"selectedValue"}},[a("van-cell-group",e._l(e.allValues,function(t,n){return a("van-cell",{key:n,attrs:{clickable:"",title:t},on:{click:function(a){e.onSelectValue(t)}}},[a("van-radio",{staticClass:"alignRight",attrs:{name:t,"checked-color":"#3fcc8e",labelPosition:!0}})],1)}))],1)],1)],1)},h=[],f=function(e){function t(){var e;return Object(o["a"])(this,t),e=Object(r["a"])(this,Object(c["a"])(t).apply(this,arguments)),e.selectedValue="",e.isBusy=!1,e.allValues=[],e}return Object(l["a"])(t,[{key:"onDicKeyChanged",value:function(e,t){this.allValues=[],this.selectedValue="",this.queryDictionaryValueList(e)}},{key:"onCurrentValueChanged",value:function(e,t){this.selectedValue=e}},{key:"created",value:function(){this.queryDictionaryValueList(this.dicKey)}},{key:"queryDictionaryValueList",value:function(e){var t=this,a=p["a"].instance.getEntCd();a&&""!==a&&e&&""!==e?(this.isBusy=!0,this.$Api.invoke({moduleName:"crm.basic.dictionaryService",className:"DictionaryService",method:"getByCd",args:{entCd:a,cd:e}}).then(function(e){e.data.data?t.allValues=e.data.data.Values:t.allValues=[]}).catch(function(e){t.allValues=[],console.log(e)}).finally(function(){t.isBusy=!1})):this.allValues=[]}},{key:"onSelectValue",value:function(e){this.selectedValue===e?this.selectedValue="":this.selectedValue=e,this.onComplete()}},{key:"onCancel",value:function(){}},{key:"onComplete",value:function(){return this.selectedValue}}]),Object(s["a"])(t,e),t}(d["default"]);u["a"]([Object(m["d"])({default:""}),u["b"]("design:type",String)],f.prototype,"title",void 0),u["a"]([Object(m["d"])({default:""}),u["b"]("design:type",String)],f.prototype,"dicKey",void 0),u["a"]([Object(m["d"])({default:""}),u["b"]("design:type",String)],f.prototype,"currentValue",void 0),u["a"]([Object(m["f"])("dicKey"),u["b"]("design:type",Function),u["b"]("design:paramtypes",[String,String]),u["b"]("design:returntype",void 0)],f.prototype,"onDicKeyChanged",null),u["a"]([Object(m["f"])("currentValue"),u["b"]("design:type",Function),u["b"]("design:paramtypes",[String,String]),u["b"]("design:returntype",void 0)],f.prototype,"onCurrentValueChanged",null),u["a"]([Object(m["b"])("cancel"),u["b"]("design:type",Function),u["b"]("design:paramtypes",[]),u["b"]("design:returntype",void 0)],f.prototype,"onCancel",null),u["a"]([Object(m["b"])("complete"),u["b"]("design:type",Function),u["b"]("design:paramtypes",[]),u["b"]("design:returntype",void 0)],f.prototype,"onComplete",null),f=u["a"]([m["a"]],f);var v=f,g=v,y=g,b=(a("2312"),a("2877")),w=Object(b["a"])(y,C,h,!1,null,"1347264e",null);w.options.__file="selectDictionaryValue.vue";var k=w.exports,x=a("3cda"),S=a("46c4"),V=function(e){function t(){var e;return Object(o["a"])(this,t),e=Object(r["a"])(this,Object(c["a"])(t).apply(this,arguments)),e.showSelectDictionaryValue=!1,e.popupTitle="",e.popupDicKey="",e.popupOldValue=null,e.isBusy=!1,e.newCustomer={EntId:"",EntCd:"",Name:"",Cd:"",Ctrl:"",SimpleName:"",Address:"",Longitude:"",Latitude:"",LocationDesc:"",Level:"",Telephone:"",Fax:"",ManagementCompany:"",IndustryCategory:"",MainProduction:"",Hobbies:"",DevelopProgress:"",CompetitorSituation:"",CompetitorAnalysis:"",AccountPeriod:"",CreditSituation:"",ContractAgreement:"",BusinessScale:"",Remark:""},e.customerContacts=[],e}return Object(l["a"])(t,[{key:"onEnter",value:function(){if(this.currentLocation=this.$route.params.location,!this.currentLocation||!this.currentLocation.point)return S["a"].toastMessage("没有定位信息,请重新定位!",4e3),void this.goBack();this.initCustomer()}},{key:"initCustomer",value:function(){this.newCustomer.EntId=p["a"].instance.getEntId(),this.newCustomer.EntCd=p["a"].instance.getEntCd(),this.newCustomer.Longitude=this.currentLocation.point.lng,this.newCustomer.Latitude=this.currentLocation.point.lat,this.newCustomer.LocationDesc=this.currentLocation.address}},{key:"beforeRouteEnter",value:function(e,t,a){a(function(e){e.onEnter()})}},{key:"goBack",value:function(){var e=this;S["a"].dialogConfirm("温馨提示","请确认要放弃新增客户?").then(function(){e.$router.back()}).catch(function(){})}},{key:"createCustomerContact",value:function(){this.customerContacts||(this.customerContacts=[]);var e={Name:"",Telephone:"",Email:"",Department:"",Title:""};this.customerContacts.push(e)}},{key:"confirmDeleteCustomerContact",value:function(e){var t=this;S["a"].dialogConfirm("温馨提示","请确认要删除客户联系人?").then(function(){t.deleteCustomerContact(e)}).catch(function(){})}},{key:"deleteCustomerContact",value:function(e){!this.customerContacts||0===this.customerContacts.length||e<0||this.customerContacts.splice(e,1)}},{key:"confirmCreateCustomer",value:function(){this.checkUserInput()&&this.saveNewCustomer()}},{key:"saveNewCustomer",value:function(){var e=this,t=p["a"].instance.getPersonId();this.isBusy=!0,this.$Api.invoke({moduleName:"crm.basic.customerService",className:"CustomerService",method:"createCustomer",args:{personId:t,customerBasicInfo:this.newCustomer,customerContacts:this.customerContacts}}).then(function(t){t.data&&t.data.isSuccess?e.createCustomerSuccess(t):S["a"].toastMessage("新增客户失败!"+t.data.error,4e3),console.log(t)}).catch(function(e){S["a"].toastMessage("新增客户异常!"+e,4e3),console.log(e)}).finally(function(){e.isBusy=!1})}},{key:"createCustomerSuccess",value:function(e){this.$router.replace({path:"/customerDetails",query:{id:e.data.data}})}},{key:"checkUserInput",value:function(){return this.currentLocation&&this.currentLocation.point?this.newCustomer.Name?!!this.newCustomer.Address||(S["a"].toastMessage("请输入客户地址!"),!1):(S["a"].toastMessage("请输入客户名称!"),!1):(S["a"].toastMessage("没有定位信息,请重新定位!"),!1)}},{key:"openSelectDictionaryValue",value:function(e,t,a,n){this.popupDicKey=e,this.popupTitle=t,this.popupOldValue=a,this.setValueCallback=n,this.showSelectDictionaryValue=!0}},{key:"cancelSelectDictionaryValue",value:function(){this.showSelectDictionaryValue=!1}},{key:"completeSelectDictionaryValue",value:function(e){this.setValueCallback(e),this.showSelectDictionaryValue=!1,this.popupOldValue=null}}]),Object(s["a"])(t,e),t}(d["default"]);V=u["a"]([Object(m["a"])({components:{selectDictionaryValue:k,crmLoading:x["a"]}})],V);var A=V,D=A,B=D,O=(a("f1db"),Object(b["a"])(B,n,i,!1,null,"596edb33",null));O.options.__file="createCustomer.vue";t["default"]=O.exports},"6e19":function(e,t,a){"use strict";var n=a("82b3"),i=a.n(n);i.a},"82b3":function(e,t,a){},f1db:function(e,t,a){"use strict";var n=a("3b33"),i=a.n(n);i.a},f332:function(e,t,a){}}]);