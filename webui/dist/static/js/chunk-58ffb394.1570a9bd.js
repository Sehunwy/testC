(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-58ffb394"],{3570:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("van-nav-bar",{staticClass:"headBar fixedHeader",on:{"click-left":e.goBack,"click-right":e.createNewItem}},[a("span",{staticClass:"icon iconfont icon-fanhui headBarIcon",attrs:{slot:"left"},slot:"left"}),a("span",{staticClass:"headBarTitle",attrs:{slot:"title"},slot:"title"},[e._v("新增事项")]),a("span",{staticClass:"icon iconfont icon-queding headBarIcon",attrs:{slot:"right"},slot:"right"})]),a("div",{staticClass:"content contentTop",attrs:{id:"contentContainer"}},[a("crmLoading",{directives:[{name:"show",rawName:"v-show",value:e.isBusy,expression:"isBusy"}]}),a("van-cell-group",[a("van-field",{attrs:{label:"客户",placeholder:"请选择客户","input-align":"right",required:"",readonly:"","is-link":!e.disableSelectCustomer,disabled:e.disableSelectCustomer},on:{click:function(t){e.openSelectCustomerPopup()}},model:{value:e.newItem.CustomerName,callback:function(t){e.$set(e.newItem,"CustomerName",t)},expression:"newItem.CustomerName"}}),a("van-field",{attrs:{label:"事项名称",placeholder:"请输入事项名称","input-align":"right",required:"",type:"textarea",rows:"1",autosize:""},model:{value:e.newItem.Name,callback:function(t){e.$set(e.newItem,"Name",t)},expression:"newItem.Name"}}),a("van-cell",{attrs:{title:"事项等级"}},[a("van-radio-group",{model:{value:e.newItem.Level,callback:function(t){e.$set(e.newItem,"Level",t)},expression:"newItem.Level"}},[a("van-radio",{staticClass:"levelRadio",attrs:{"checked-color":"#3fcc8e",name:Number(1)}},[e._v("一般")]),a("van-radio",{staticClass:"levelRadio marginLeft20",attrs:{"checked-color":"#3fcc8e",name:Number(2)}},[e._v("高")])],1)],1),a("van-field",{attrs:{label:"概述",placeholder:"请输入事项概述","input-align":"right",type:"textarea",rows:"1",autosize:""},model:{value:e.newItem.Description,callback:function(t){e.$set(e.newItem,"Description",t)},expression:"newItem.Description"}})],1),a("van-cell-group",{staticStyle:{"margin-top":"10px"}},[a("van-field",{attrs:{label:"分析",placeholder:"请输入事项分析",type:"textarea",autosize:{maxHeight:120,minHeight:80}},model:{value:e.newItem.Analyze,callback:function(t){e.$set(e.newItem,"Analyze",t)},expression:"newItem.Analyze"}}),a("van-field",{attrs:{label:"下一计划",placeholder:"请输入下一计划内容",type:"textarea",autosize:{maxHeight:120,minHeight:80}},model:{value:e.newItem.NextPlan,callback:function(t){e.$set(e.newItem,"NextPlan",t)},expression:"newItem.NextPlan"}}),a("van-field",{attrs:{label:"备注",placeholder:"请输入备注内容",type:"textarea",autosize:{maxHeight:120,minHeight:80}},model:{value:e.newItem.Remark,callback:function(t){e.$set(e.newItem,"Remark",t)},expression:"newItem.Remark"}})],1)],1),a("van-popup",{staticStyle:{height:"100%",width:"100%"},attrs:{overlay:!1,"close-on-click-overlay":!1,position:"right"},model:{value:e.showSelectCustomerPopup,callback:function(t){e.showSelectCustomerPopup=t},expression:"showSelectCustomerPopup"}},[a("selectCustomer",{attrs:{title:"选择客户",showComponent:!0},on:{goBack:e.closeSelectCustomerPopup,complete:e.selectCustomerComplete}})],1)],1)},s=[],o=a("c665"),i=a("dc0a"),c=a("aa9a"),l=a("d328"),r=a("11d9"),u=a("9ab4"),m=a("2b0e"),d=a("60a3"),p=a("2b67"),h=a("b177"),v=a("3cda"),I=a("46c4"),f=function(e){function t(){var e;return Object(o["a"])(this,t),e=Object(l["a"])(this,Object(r["a"])(t).apply(this,arguments)),e.currentPersonId="",e.isBusy=!1,e.showSelectCustomerPopup=!1,e.disableSelectCustomer=!1,e.newItem={EntId:"",EntCd:"",Name:"",Description:"",CustomerId:"",CustomerName:"",Type:"",Level:1,Analyze:"",NextPlan:"",Remark:""},e}return Object(c["a"])(t,[{key:"created",value:function(){this.currentPersonId=p["a"].instance.getPersonId(),this.newItem.EntId=p["a"].instance.getEntId(),this.newItem.EntCd=p["a"].instance.getEntCd();var e=this.$route.query.customerId,t=this.$route.query.customerName;this.newItem.CustomerId=e||"",this.newItem.CustomerName=t||"",this.newItem.CustomerId&&this.newItem.CustomerName&&(this.disableSelectCustomer=!0)}},{key:"createNewItem",value:function(){var e=this;this.checkInput()&&(this.isBusy=!0,this.$Api.invoke({moduleName:"crm.item.itemService",className:"ItemService",method:"createItem",args:{personId:this.currentPersonId,item:this.newItem}}).then(function(t){t.data&&t.data.isSuccess?(e.notifyRefreshItemIndicator(),e.goBack()):(I["a"].toastMessage("新增事项失败!"+t.data.error),console.log(t))}).catch(function(e){I["a"].toastMessage("新增事项异常!"+e),console.log(e)}).finally(function(){e.isBusy=!1}))}},{key:"notifyRefreshItemIndicator",value:function(){this.$store.commit("changeRefreshSelfItemIndicator")}},{key:"checkInput",value:function(){return this.newItem.Name?!(!this.newItem.CustomerId||!this.newItem.CustomerName)||(I["a"].toastMessage("请选择客户!"),!1):(I["a"].toastMessage("事项名称不能为空!"),!1)}},{key:"openSelectCustomerPopup",value:function(){this.showSelectCustomerPopup=!0}},{key:"closeSelectCustomerPopup",value:function(){this.showSelectCustomerPopup=!1}},{key:"selectCustomerComplete",value:function(e){e&&e.Id&&(this.newItem.CustomerId=e.Id,this.newItem.CustomerName=e.Name,this.showSelectCustomerPopup=!1)}},{key:"goBack",value:function(){this.$router.back()}}]),Object(i["a"])(t,e),t}(m["default"]);f=u["a"]([Object(d["a"])({components:{selectCustomer:h["a"],crmLoading:v["a"]}})],f);var w=f,b=w,C=b,g=(a("b616"),a("2877")),k=Object(g["a"])(C,n,s,!1,null,"0cc8cca4",null);k.options.__file="createItem.vue";t["default"]=k.exports},"3cda":function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"alignCenter width100"},[a("van-loading",{staticStyle:{display:"inline-block"}})],1)},s=[],o=a("c665"),i=a("dc0a"),c=a("d328"),l=a("11d9"),r=a("9ab4"),u=a("2b0e"),m=a("60a3"),d=function(e){function t(){return Object(o["a"])(this,t),Object(c["a"])(this,Object(l["a"])(t).apply(this,arguments))}return Object(i["a"])(t,e),t}(u["default"]);d=r["a"]([m["a"]],d);var p=d,h=p,v=h,I=(a("6e19"),a("2877")),f=Object(I["a"])(v,n,s,!1,null,"04a46e72",null);f.options.__file="crmLoading.vue";t["a"]=f.exports},"406d":function(e,t,a){},"6e19":function(e,t,a){"use strict";var n=a("82b3"),s=a.n(n);s.a},"82b3":function(e,t,a){},b616:function(e,t,a){"use strict";var n=a("406d"),s=a.n(n);s.a}}]);