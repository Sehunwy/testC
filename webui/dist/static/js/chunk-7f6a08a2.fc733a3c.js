(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7f6a08a2"],{"07f2":function(e,t,a){"use strict";var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{attrs:{inline:!0}},[a("el-form-item",{attrs:{label:"选择产品"}},[a("el-select",{attrs:{loading:e.isLoading,"value-key":"Id",clearable:"",placeholder:"选择物料",filterable:"",remote:"","remote-method":e.getKeys},on:{change:e.change},model:{value:e.id,callback:function(t){e.id=t},expression:"id"}},e._l(e.materialList,function(t,l){return a("el-option",{key:l,attrs:{value:t.Id,label:t.Name}},[a("span",{staticStyle:{float:"left"}},[e._v(e._s(t.Id))]),a("span",{staticStyle:{float:"left",margin:"0 20px"}},[e._v(e._s(t.Ctrl))]),a("span",{staticStyle:{float:"right"}},[e._v(e._s(t.Name))])])}))],1)],1)},r=[],i=a("c665"),s=a("dc0a"),o=a("aa9a"),n=a("d328"),u=a("11d9"),c=a("9ab4"),p=a("2b0e"),d=a("60a3"),m=function(e){function t(){var e;return Object(i["a"])(this,t),e=Object(n["a"])(this,Object(u["a"])(t).apply(this,arguments)),e.isLoading=!1,e.id="",e.materialList=[],e.req={moduleName:"mes.business.pub.service",className:"MaterialService",method:"getKeys",args:{key:""}},e}return Object(o["a"])(t,[{key:"getKeys",value:function(e){var t=this;this.isLoading=!0,this.req.args.key=e,this.$Api.invoke(this.req).then(function(e){t.materialList=e.data.data}).finally(function(){t.isLoading=!1})}},{key:"change",value:function(e){}},{key:"mounted",value:function(){this.getKeys("")}}]),Object(s["a"])(t,e),t}(p["default"]);c["a"]([Object(d["b"])(),c["b"]("design:type",Function),c["b"]("design:paramtypes",[Object]),c["b"]("design:returntype",void 0)],m.prototype,"change",null),m=c["a"]([d["a"]],m);var b=m,h=b,g=h,f=(a("3266"),a("2877")),y=Object(f["a"])(g,l,r,!1,null,"3d49bd7f",null);y.options.__file="materialSelect.vue";t["a"]=y.exports},3266:function(e,t,a){"use strict";var l=a("3578"),r=a.n(l);r.a},3578:function(e,t,a){},"81db":function(e,t,a){"use strict";a.r(t);var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{height:"auto"},attrs:{"v-loading":e.isBusy}},[a("el-form",{directives:[{name:"show",rawName:"v-show",value:e.isShowSelect,expression:"isShowSelect"}],attrs:{inline:!0}},[a("el-form-item",{attrs:{label:""}},[a("material-select",{on:{change:e.getMaterial}})],1)],1),a("el-form",{attrs:{inline:!0,model:e.args}},[a("el-form-item",{attrs:{label:"物料编码"}},[a("el-input",{attrs:{placeholder:"",readonly:""},model:{value:e.args.Cd,callback:function(t){e.$set(e.args,"Cd",t)},expression:"args.Cd"}})],1),a("el-form-item",{attrs:{label:"物料型号"}},[a("el-input",{attrs:{placeholder:"",readonly:""},model:{value:e.args.Ctrl,callback:function(t){e.$set(e.args,"Ctrl",t)},expression:"args.Ctrl"}})],1),a("el-form-item",{attrs:{label:"物料名称"}},[a("el-input",{attrs:{placeholder:"",readonly:""},model:{value:e.args.Name,callback:function(t){e.$set(e.args,"Name",t)},expression:"args.Name"}})],1),a("el-form-item",{attrs:{label:"数量"}},[a("el-input-number",{attrs:{placeholder:""},model:{value:e.args.Quantity,callback:function(t){e.$set(e.args,"Quantity",t)},expression:"args.Quantity"}})],1),a("el-form-item",{attrs:{label:"单位"}},[a("el-input",{attrs:{placeholder:"",readonly:""},model:{value:e.args.MeasureName,callback:function(t){e.$set(e.args,"MeasureName",t)},expression:"args.MeasureName"}})],1),a("el-form-item",{attrs:{label:"规格"}},[a("el-input",{attrs:{placeholder:"",readonly:""},model:{value:e.args.PackingSpec,callback:function(t){e.$set(e.args,"PackingSpec",t)},expression:"args.PackingSpec"}})],1)],1),a("el-card",{staticStyle:{height:"auto"}},[a("div",{staticStyle:{height:"15px"},attrs:{slot:"header"},slot:"header"},[a("h3",[e._v("当前库存")])]),a("el-table",{attrs:{data:e.storage,"show-summary":"","summary-method":e.getsummaries,"max-height":"300px"}},[a("el-table-column",{attrs:{label:"公司",prop:"Corp",width:"80"}}),a("el-table-column",{attrs:{label:"仓库",prop:"WarehourseName",width:"200"}}),a("el-table-column",{attrs:{label:"物料编码",prop:"MaterialCd",width:"120"}}),a("el-table-column",{attrs:{label:"型号",prop:"MaterialStd",width:"120"}}),a("el-table-column",{attrs:{label:"名称",prop:"MaterialName",width:"300"}}),a("el-table-column",{attrs:{label:"形态",prop:"MaterialForm",width:"200"}}),a("el-table-column",{attrs:{label:"批次",prop:"BatchCode",width:"120"}}),a("el-table-column",{attrs:{label:"规格",prop:"PackingSpec",width:"100"}}),a("el-table-column",{attrs:{label:"数量",prop:"Quantity",width:"150"}}),a("el-table-column",{attrs:{label:"单位",prop:"MeasureName",width:"100"}})],1)],1),a("hr"),a("el-card",[a("div",{staticStyle:{height:"20px",margin:"0 auto"},attrs:{slot:"header"},slot:"header"},[a("h3",[e._v("原辅料测算")])]),a("el-table",{attrs:{data:e.boms,"row-key":"Id","row-class-name":e.getRowClassName,"highlight-current-row":!0}},[a("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(e){return[a("el-table",{attrs:{data:e.row.Storage.Lots}},[a("el-table-column",{attrs:{label:"公司",prop:"Corp",width:"80"}}),a("el-table-column",{attrs:{label:"仓库",prop:"WarehourseName",width:"200"}}),a("el-table-column",{attrs:{label:"物料编码",prop:"MaterialCd",width:"120"}}),a("el-table-column",{attrs:{label:"型号",prop:"MaterialStd",width:"120"}}),a("el-table-column",{attrs:{label:"名称",prop:"MaterialName",width:"300"}}),a("el-table-column",{attrs:{label:"形态",prop:"MaterialForm",width:"200"}}),a("el-table-column",{attrs:{label:"批次",prop:"BatchCode",width:"120"}}),a("el-table-column",{attrs:{label:"规格",prop:"PackingSpec",width:"100"}}),a("el-table-column",{attrs:{label:"数量",prop:"Quantity",width:"150"}}),a("el-table-column",{attrs:{label:"单位",prop:"MeasureName",width:"100"}})],1)]}}])}),a("el-table-column",{attrs:{label:"层级",prop:"Level"}}),a("el-table-column",{attrs:{label:"母件编码",prop:"PMatCd"}}),a("el-table-column",{attrs:{label:"母件名称",prop:"PMatName"}}),a("el-table-column",{attrs:{label:"子件编码",prop:"CMatCd"}}),a("el-table-column",{attrs:{label:"子件名称",prop:"CMatName"}}),a("el-table-column",{attrs:{label:"单位用量",prop:"Ratio"}}),a("el-table-column",{attrs:{label:"需求量",prop:"Qua"}}),a("el-table-column",{attrs:{label:"单位",prop:"Measure"}}),a("el-table-column",{attrs:{label:"采购/自制",prop:"Att"}}),a("el-table-column",{attrs:{label:"库存量",prop:"StorageQua"}}),a("el-table-column",{attrs:{label:"库存单位",prop:"StorageMeasure"}}),a("el-table-column",{attrs:{label:"差异",prop:"Diff"}}),a("el-table-column",{attrs:{label:"提示"}})],1)],1)],1)},r=[],i=(a("7f7f"),a("ac6a"),a("c665")),s=a("dc0a"),o=a("aa9a"),n=a("d328"),u=a("11d9"),c=a("9ab4"),p=a("2b0e"),d=a("60a3"),m=a("07f2"),b=a("0063"),h=a.n(b),g=function(e){function t(){var e;return Object(i["a"])(this,t),e=Object(n["a"])(this,Object(u["a"])(t).apply(this,arguments)),e.materialId="",e.isShowSelect=!0,e.isBusy=!1,e.args={},e.storage=[],e.boms=[],e.sumProp=["Quantity"],e.req={reqM:{moduleName:"mes.business.pub.service",className:"MaterialService",method:"getMaterial",args:{id:""}},reqCaculation:{}},e}return Object(o["a"])(t,[{key:"caculation",value:function(){var e=this;if(this.args.Id){if(this.args.Quantity<=0)return;this.isBusy=!0;var t={moduleName:"mes.business.aps.schedule",className:"RawMaterialCaculation",method:"caculation",args:{cd:this.args.Cd,qua:this.args.Quantity,measure:this.args.MeasureName,spec:this.args.PackingSpec}};this.$Api.invoke(t).then(function(t){e.boms=t.data.data}).finally(function(){e.isBusy=!1})}}},{key:"getsummaries",value:function(e){var t=this,a=e.columns,l=e.data,r=[];return a.forEach(function(e,a){if(0!==a)if(t.sumProp.indexOf(e.property)>=0){var i=h.a.from(l);r[a]=i.sum(function(t){return t[e.property]})}else r[a]="";else r[a]="合计"}),r}},{key:"getMaterial",value:function(e){var t=this;e?(this.isBusy=!0,this.req.reqM.args.id=e,this.$Api.invoke(this.req.reqM).then(function(e){var a=e.data.data[0];if(t.order){var l=t.order;a.MeasureName=l.Measure,a.PackingSpec=l.Spec,a.Quantity=l.Qua}else a.Quantity=100;t.args=a,t.storage=e.data.data[1]}).finally(function(){t.isBusy=!1})):this.args={}}},{key:"getRowClassName",value:function(e){var t=e.row;e.index;return t.Diff<=0?"danger-row":t.Diff<200?"warning-row":void 0}},{key:"created",value:function(){this.onNavigation(this.$route,null)}},{key:"onNavigation",value:function(e,t){if("materialCaculation"===e.name)try{var a={};e.query.id?(a.MaterialId=e.query.id,a.Qua=e.query.qua,a.Spec=e.query.spec,a.Measure=e.query.measure,this.order=a,this.isShowSelect=!1,this.getMaterial(a.MaterialId)):(this.isShowSelect=!0,this.order=null,this.boms=[],this.args={},this.storage=[])}catch(e){console.log(e)}}}]),Object(s["a"])(t,e),t}(p["default"]);c["a"]([Object(d["f"])("args",{deep:!0}),c["b"]("design:type",Function),c["b"]("design:paramtypes",[]),c["b"]("design:returntype",void 0)],g.prototype,"caculation",null),c["a"]([Object(d["f"])("$route"),c["b"]("design:type",Function),c["b"]("design:paramtypes",[Object,Object]),c["b"]("design:returntype",void 0)],g.prototype,"onNavigation",null),g=c["a"]([Object(d["a"])({components:{MaterialSelect:m["a"]}})],g);var f=g,y=f,v=y,S=(a("a6e9"),a("2877")),w=Object(S["a"])(v,l,r,!1,null,"7e417e62",null);w.options.__file="materialCaculation.vue";t["default"]=w.exports},a6e9:function(e,t,a){"use strict";var l=a("c7fb"),r=a.n(l);r.a},ac6a:function(e,t,a){for(var l=a("cadf"),r=a("0d58"),i=a("2aba"),s=a("7726"),o=a("32e9"),n=a("84f2"),u=a("2b4c"),c=u("iterator"),p=u("toStringTag"),d=n.Array,m={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},b=r(m),h=0;h<b.length;h++){var g,f=b[h],y=m[f],v=s[f],S=v&&v.prototype;if(S&&(S[c]||o(S,c,d),S[p]||o(S,p,f),n[f]=d,y))for(g in l)S[g]||i(S,g,l[g],!0)}},c7fb:function(e,t,a){}}]);